import{r as o,i as M,j as t,k as y}from"./index-Du8wxtP2.js";import{a as d}from"./axios-CCb-kr4I.js";import{S as F}from"./SmallNavBar-BzaAMooq.js";function P(){const[n,h]=o.useState(""),[c,p]=o.useState(""),[u,m]=o.useState(""),[r,f]=o.useState(null),[b,l]=o.useState(""),[g,D]=o.useState(!1),[x,E]=o.useState(null),[U,B]=o.useState({title:"",shortDescription:""}),{id:j}=M();o.useEffect(()=>{console.log("this is the id",j),f(j),r&&(async()=>{try{const e=await d.get(`http://localhost:3000/blogs/${r}`),{jsonData:a,title:i,short_description:I,image:N}=e.data;h(i||""),p(I||""),m(N||"");const w=typeof a=="string"?JSON.parse(a):a;B(w),D(!0)}catch(e){l("Failed to fetch blog data."),console.error("Error fetching blog data:",e)}})()},[r]),o.useEffect(()=>{(async()=>{try{const e=`http://localhost:3000/uploads/${r}`;E(e)}catch(e){console.error("Error fetching image:",e)}})()},[r]);const S=async()=>{const e={title:n,shortDescription:c,image:u,jsonData:{title:n,shortDescription:c}};try{const a=await d.post("http://localhost:3000/blogs",e);f(a.data.blogId),l(""),alert("Blog created successfully!")}catch(a){l("Failed to create the blog. Please try again."),console.error("Error creating blog:",a)}},v=async()=>{const e={title:n,shortDescription:c,image:u,jsonData:{title:n,shortDescription:c}};try{await d.put(`http://localhost:3000/blogs/${r}`,e),l(""),alert("Blog updated successfully!")}catch(a){l("Failed to update the blog. Please try again."),console.error("Error updating blog:",a)}},C=async s=>{const e=s.target.files[0];if(!e){l("Please choose an image to upload.");return}const a=new FormData;a.append("image",e);try{const i=await d.post(`http://localhost:3000/blogs/${r}/upload`,a,{headers:{"Content-Type":"multipart/form-data"}});m(i.data.imageUrl),alert("Image uploaded successfully!")}catch(i){l("Failed to upload the image. Please try again."),console.error("Error uploading image:",i)}};return t.jsxs("div",{className:"bg-brandLightMaroon/30 border h-[100%] p-16 container flex flex-col gap-4 relative",children:[t.jsx("h1",{children:g?"Edit Blog":"Create Blog"}),t.jsxs("div",{className:"bg-brandWhite bg-opacity-50 p-8 rounded-md",children:[t.jsx("h3",{children:"Set the title"}),t.jsx(y,{value:n,onChange:s=>h(s)})]}),t.jsxs("div",{className:"bg-brandWhite bg-opacity-50 p-8 rounded-md",children:[t.jsx("p",{children:"Set the body"}),t.jsx(y,{value:c,onChange:s=>p(s)})]}),t.jsx("button",{className:"mt-6 px-8 py-2 bg-brandLightMaroon hover:bg-brandDarkMaroon self-center transition-all duration-200 text-white rounded-lg",onClick:g?v:S,children:g?"Update Blog":"Create Blog"}),b&&t.jsx("p",{style:{color:"red"},children:b}),t.jsxs("div",{children:[t.jsx("p",{children:"Upload the image"}),t.jsx("input",{type:"file",onChange:C})]}),t.jsx("div",{className:"w-52 ",children:x==null?t.jsx("img",{src:x,alt:`Blog ${r}`,style:{}}):""})]})}function O(){return t.jsxs("div",{className:"p-4 min-h-screen bg-brandDarkMaroon",children:[t.jsx(F,{}),t.jsx(P,{})]})}export{O as default};
